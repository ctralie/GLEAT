<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!--External Libraries!-->
<script type = "text/javascript" src = "js/ammo.js"></script>
<!--<script type="text/javascript" src="js/gl-matrix.js"></script>!-->
<script type="text/javascript" src = "js/gl-matrix-min.js"></script>
<script type="text/javascript" src="js/webgl-utils.js"></script>
<script type="text/javascript" src="js/numeric-1.2.6.min.js"></script>
<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>

<!--Our Scripts!-->
<script src="PolyMesh.js"></script>
<script src="Primitives3D.js"></script>
</head>

<body onload="webGLStart();">

<table>
<tr><td><h3>Mesh File</h3></td><td><input type = "file" id = "meshInput"></td></tr>
</table>
<canvas id="MainGLCanvas" style="border: none;" width="800" height="600"></canvas>

<script>
	//Load in the mesh
	var meshInput = document.getElementById('meshInput');
	var result = document.getElementById('text');
	
	meshInput.addEventListener('change', function(e) {
		var file = meshInput.files[0];
		var textType = /text.*/;
		
		if (file.type.match(textType) || file.type == "model/x-geomview-off") {
			var reader = new FileReader();
			reader.onload = function(e) {
				var lines = reader.result.split("\n");
				var mesh = new PolyMesh();
				mesh.loadFile(lines);
			}
			reader.readAsText(file);	
		} else {
			console.log("File type not supported for mesh!  Expecting text or OFF file");
		}
	});
	
	function initGL(canvas) {
		try {
		    gl = canvas.getContext("experimental-webgl");
		    gl.viewportWidth = canvas.width;
		    gl.viewportHeight = canvas.height;
		} catch (e) {
		}
		if (!gl) {
		    alert("Could not initialise WebGL, sorry :-(.  Try a new version of chrome or firefox and make sure your newest graphics drivers are installed");
		}
	}

	
	
</script>

</body>
</html>
